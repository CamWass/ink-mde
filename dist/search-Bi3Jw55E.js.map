{"version":3,"file":"search-Bi3Jw55E.js","sources":["../src/editor/extensions/search.tsx"],"sourcesContent":["import {\n  SearchQuery,\n  findNext,\n  findPrevious,\n  getSearchQuery,\n  search as searchExtension,\n  searchKeymap,\n  setSearchQuery,\n} from '@codemirror/search'\nimport { keymap, runScopeHandlers } from '@codemirror/view'\n\nexport const search = () => {\n  return [\n    searchExtension({\n      top: true,\n      createPanel: (view) => {\n        let query = getSearchQuery(view.state)\n\n        const wrapper = document.createElement('div')\n        const input = document.createElement('input')\n\n        wrapper.setAttribute('class', 'ink-mde-search-panel')\n        input.setAttribute('attr:main-field', 'true')\n        input.setAttribute('class', 'ink-mde-search-input')\n        input.setAttribute('type', 'text')\n        input.setAttribute('value', query.search)\n\n        wrapper.appendChild(input)\n\n        const handleKeyDown = (event: KeyboardEvent) => {\n          if (runScopeHandlers(view, event, 'search-panel')) return event.preventDefault()\n\n          if (event.code === 'Enter') {\n            event.preventDefault()\n\n            if (event.shiftKey) {\n              findPrevious(view)\n            } else {\n              findNext(view)\n            }\n          }\n        }\n\n        const updateSearch = (event: Event) => {\n          // @ts-expect-error \"value\" is not a recognized property of EventTarget.\n          const { value } = event.target\n\n          query = new SearchQuery({ search: value })\n\n          view.dispatch({ effects: setSearchQuery.of(query) })\n        }\n\n        input.addEventListener('input', updateSearch)\n        input.addEventListener('keydown', handleKeyDown)\n\n        return {\n          dom: wrapper,\n          mount: () => {\n            input.focus()\n          },\n          top: true,\n        }\n      },\n    }),\n    keymap.of(searchKeymap),\n  ]\n}\n"],"names":["search","searchExtension","top","createPanel","view","query","getSearchQuery","state","wrapper","document","createElement","input","setAttribute","appendChild","handleKeyDown","event","runScopeHandlers","preventDefault","code","shiftKey","findPrevious","findNext","updateSearch","value","target","SearchQuery","dispatch","effects","setSearchQuery","of","addEventListener","dom","mount","focus","keymap","searchKeymap"],"mappings":";;;AAWaA,MAAAA,MAAM,GAAGA,MAAM;EAC1B,OAAO,CACLC,QAAe,CAAC;AACdC,IAAAA,GAAG,EAAE,IAAI;IACTC,WAAW,EAAGC,IAAI,IAAK;AACrB,MAAA,IAAIC,KAAK,GAAGC,cAAc,CAACF,IAAI,CAACG,KAAK,CAAC,CAAA;AAEtC,MAAA,MAAMC,OAAO,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC,CAAA;AAC7C,MAAA,MAAMC,KAAK,GAAGF,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC,CAAA;AAE7CF,MAAAA,OAAO,CAACI,YAAY,CAAC,OAAO,EAAE,sBAAsB,CAAC,CAAA;AACrDD,MAAAA,KAAK,CAACC,YAAY,CAAC,iBAAiB,EAAE,MAAM,CAAC,CAAA;AAC7CD,MAAAA,KAAK,CAACC,YAAY,CAAC,OAAO,EAAE,sBAAsB,CAAC,CAAA;AACnDD,MAAAA,KAAK,CAACC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,CAAA;MAClCD,KAAK,CAACC,YAAY,CAAC,OAAO,EAAEP,KAAK,CAACL,MAAM,CAAC,CAAA;AAEzCQ,MAAAA,OAAO,CAACK,WAAW,CAACF,KAAK,CAAC,CAAA;MAE1B,MAAMG,aAAa,GAAIC,KAAoB,IAAK;AAC9C,QAAA,IAAIC,gBAAgB,CAACZ,IAAI,EAAEW,KAAK,EAAE,cAAc,CAAC,EAAE,OAAOA,KAAK,CAACE,cAAc,EAAE,CAAA;AAEhF,QAAA,IAAIF,KAAK,CAACG,IAAI,KAAK,OAAO,EAAE;UAC1BH,KAAK,CAACE,cAAc,EAAE,CAAA;UAEtB,IAAIF,KAAK,CAACI,QAAQ,EAAE;YAClBC,YAAY,CAAChB,IAAI,CAAC,CAAA;AACpB,WAAC,MAAM;YACLiB,QAAQ,CAACjB,IAAI,CAAC,CAAA;AAChB,WAAA;AACF,SAAA;OACD,CAAA;MAED,MAAMkB,YAAY,GAAIP,KAAY,IAAK;AACrC;QACA,MAAM;AAAEQ,UAAAA,KAAAA;SAAO,GAAGR,KAAK,CAACS,MAAM,CAAA;QAE9BnB,KAAK,GAAG,IAAIoB,WAAW,CAAC;AAAEzB,UAAAA,MAAM,EAAEuB,KAAAA;AAAM,SAAC,CAAC,CAAA;QAE1CnB,IAAI,CAACsB,QAAQ,CAAC;AAAEC,UAAAA,OAAO,EAAEC,cAAc,CAACC,EAAE,CAACxB,KAAK,CAAA;AAAE,SAAC,CAAC,CAAA;OACrD,CAAA;AAEDM,MAAAA,KAAK,CAACmB,gBAAgB,CAAC,OAAO,EAAER,YAAY,CAAC,CAAA;AAC7CX,MAAAA,KAAK,CAACmB,gBAAgB,CAAC,SAAS,EAAEhB,aAAa,CAAC,CAAA;MAEhD,OAAO;AACLiB,QAAAA,GAAG,EAAEvB,OAAO;QACZwB,KAAK,EAAEA,MAAM;UACXrB,KAAK,CAACsB,KAAK,EAAE,CAAA;SACd;AACD/B,QAAAA,GAAG,EAAE,IAAA;OACN,CAAA;AACH,KAAA;GACD,CAAC,EACFgC,MAAM,CAACL,EAAE,CAACM,YAAY,CAAC,CACxB,CAAA;AACH;;;;"}
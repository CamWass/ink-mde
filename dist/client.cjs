"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const i=require("solid-js/web"),q=require("@codemirror/language"),S=require("@codemirror/state"),K=require("@codemirror/commands"),u=require("@codemirror/view"),G=require("@codemirror/lang-markdown"),ye=require("@codemirror/language-data"),g=require("@lezer/highlight"),m=require("solid-js"),be=require("@codemirror/autocomplete"),R=require("@codemirror/search"),Be=require("@replit/codemirror-vim"),Ve="data-ink-mde-ssr-hydration-marker",Re=`[${Ve}]`,We=()=>({}),Ie=([e])=>{const{editor:t}=e();t.destroy()},ae=([e])=>{const{editor:t}=e();t.hasFocus||t.focus()};var ee=(e=>(e.Auto="auto",e.Dark="dark",e.Light="light",e))(ee||{}),b=(e=>(e.Bold="bold",e.Code="code",e.CodeBlock="code_block",e.Heading="heading",e.Image="image",e.Italic="italic",e.Link="link",e.List="list",e.OrderedList="ordered_list",e.Quote="quote",e.TaskList="task_list",e))(b||{}),se=(e=>(e.End="end",e.Start="start",e))(se||{});const le={auto:"auto",dark:"dark",light:"light"},B={completion:"completion",default:"default",grammar:"grammar",language:"language"},ve=e=>{const t=e.map(n=>S.SelectionRange.fromJSON({anchor:n.start,head:n.end}));return S.EditorSelection.create(t)},we=e=>e.ranges.map(n=>({end:n.anchor<n.head?n.head:n.anchor,start:n.head<n.anchor?n.head:n.anchor})),D=e=>({...{block:!1,line:!1,multiline:!1,nodes:[],prefix:"",prefixStates:[],suffix:""},...e}),Fe={[b.Bold]:D({nodes:["StrongEmphasis"],prefix:"**",suffix:"**"}),[b.Code]:D({nodes:["InlineCode"],prefix:"`",suffix:"`"}),[b.CodeBlock]:D({block:!0,nodes:["FencedCode"],prefix:"```\n",suffix:"\n```"}),[b.Heading]:D({multiline:!0,nodes:["ATXHeading1","ATXHeading2","ATXHeading3","ATXHeading4","ATXHeading5","ATXHeading6"],prefix:"# ",prefixStates:["# ","## ","### ","#### ","##### ","###### ",""]}),[b.Image]:D({nodes:["Image"],prefix:"![](",suffix:")"}),[b.Italic]:D({nodes:["Emphasis"],prefix:"*",suffix:"*"}),[b.Link]:D({nodes:["Link"],prefix:"[](",suffix:")"}),[b.OrderedList]:D({line:!0,multiline:!0,nodes:["OrderedList"],prefix:"1. "}),[b.Quote]:D({line:!0,multiline:!0,nodes:["Blockquote"],prefix:"> "}),[b.TaskList]:D({line:!0,multiline:!0,nodes:["BulletList"],prefix:"- [ ] "}),[b.List]:D({line:!0,multiline:!0,nodes:["BulletList"],prefix:"- "})},Qe=({editor:e,selection:t})=>{let n=t.start;const r=[];for(;n<=t.end;){const o=e.lineBlockAt(n),a=Math.max(t.start,o.from),s=Math.min(t.end,o.to);r.push({start:a,end:s}),n=o.to+1}return r},Ue=({editor:e,formatDefinition:t,selection:n})=>{if(!e||!t)return n||{start:0,end:0};const r=n||we(e.state.selection).pop()||{start:0,end:0};if(t.block||t.line||t.multiline){const s=e.lineBlockAt(r.start).from,l=e.lineBlockAt(r.end).to;return{start:s,end:l}}const o=e.state.wordAt(r.start)?.from||r.start,a=e.state.wordAt(r.end)?.to||r.end;return{start:o,end:a}},$e=e=>e.editor.state.sliceDoc(e.selection.start,e.selection.end),Ke=(e,t,n)=>Xe(e,n).find(({type:o})=>t.nodes.includes(o.name)),Xe=(e,t)=>{const n=[];return q.syntaxTree(e.state).iterate({from:t.start,to:t.end,enter:({type:r,from:o,to:a})=>{n.push({type:r,from:o,to:a})}}),n},ue=e=>{const t=$e(e),n=e.formatDefinition.prefix.length,r=e.formatDefinition.suffix.length*-1||t.length,o=t.slice(n,r);return[{from:e.selection.start,to:e.selection.end,insert:o}]},Ye=e=>{if(e.node){const t=e.node.from,n=e.node.to;return ue({...e,selection:{start:t,end:n}})}else{const t=e.formatDefinition.prefix,n=e.formatDefinition.suffix;return[{from:e.selection.start,insert:t},{from:e.selection.end,insert:n}]}},Ze=e=>{const t=Qe(e),n=[];return t.forEach(r=>{const o=_e({...e,selection:r});n.push(...o)}),n},_e=e=>{const t=e.formatDefinition.prefixStates.length>0,n=$e(e);if(e.node&&t){const r=e.formatDefinition.prefixStates.find(o=>n.startsWith(o));if(r){const o=e.formatDefinition.prefixStates.indexOf(r),a=e.formatDefinition.prefixStates[o+1],s=n.replace(new RegExp(`^${r}`),a);return[{from:e.selection.start,to:e.selection.end,insert:s}]}}else if(e.node&&n.startsWith(e.formatDefinition.prefix))return ue(e);return[{from:e.selection.start,insert:e.formatDefinition.prefix}]},Je=e=>{if(e.node){const t=e.node.from,n=e.node.to;return ue({...e,selection:{start:t,end:n}})}else{const{formatDefinition:t,selection:n}=e,r=Array.isArray(t.prefix)?t.prefix[0]:t.prefix,o=t.suffix;return[{from:n.start,insert:r},{from:n.end,insert:o}]}},Ge=e=>e.formatDefinition.block?Ye(e):e.formatDefinition.multiline?Ze(e):e.formatDefinition.line?_e(e):Je(e),Se=([e],t,{selection:n}={})=>{const{editor:r}=e(),o=Fe[t],a=Ue({editor:r,formatDefinition:o,selection:n}),s=Ke(r,o,a),c=Ge({editor:r,formatDefinition:o,node:s,selection:a}),d=c.reduce((x,k)=>{const y=k.insert.length-((k.to||k.from)-k.from);return x+y},0),f=e().editor.state.update({changes:c,selection:{head:a.start,anchor:a.end+d}});e().editor.dispatch(f)},et=([e])=>{const{editor:t}=e();return t.state.sliceDoc()},fe=([e])=>{const{editor:t}=e();return we(t.state.selection)},te=([e,t],n,r,o=!1)=>{const{editor:a}=e();let s=r?.start,l=r?.end||r?.start;if(typeof s>"u"){const d=fe([e,t]).pop();s=d.start,l=d.end}const c={changes:{from:s,to:l,insert:n}};if(o){const d=s===l?s+n.length:s,f=s+n.length;Object.assign(c,{selection:{anchor:d,head:f}})}a.dispatch(a.state.update(c))},tt={array:"[object Array]",asyncFunction:"[object AsyncFunction]",boolean:"[object Boolean]",function:"[object Function]",null:"[object Null]",number:"[object Number]",object:"[object Object]",promise:"[object Promise]",string:"[object String]",symbol:"[object Symbol]",undefined:"[object Undefined]",window:"[object Window]"},nt=(e,t)=>Object.prototype.toString.call(t)===e,Ce=e=>nt(tt.promise,e),X=e=>it(e,Ce),rt=(e,t)=>t.type===e,ot=(e,t)=>!!e&&e in t,I=(e,t)=>Ee(t.plugins).reduce((n,r)=>(rt(e,r)&&(!r.key||ot(r.key,t)&&t[r.key])&&n.push(r.value),n),[]),Ee=e=>e.reduce((t,n)=>Array.isArray(n)?t.concat(Ee(n)):t.concat(n),[]),it=(e,t)=>e.reduce((n,r)=>(t(r)?n[0].push(r):n[1].push(r),n),[[],[]]),at=([e,t])=>{const n=[],[r,o]=st(e().options),[a,s]=lt(e().options);return Math.max(r.length,a.length)>0&&e().workQueue.enqueue(async()=>{const l=await ne([e,t]);e().editor.dispatch({effects:l})}),G.markdown({base:G.markdownLanguage,codeLanguages:[...ye.languages,...s],extensions:[...n,...o]})},st=e=>X(I(B.grammar,e)),lt=e=>X(I(B.language,e)),ct=async([e])=>{const t=[],n=await Promise.all(I(B.grammar,e().options)),r=await Promise.all(I(B.language,e().options));return G.markdown({base:G.markdownLanguage,codeLanguages:[...ye.languages,...r],extensions:[...t,...n]})},dt=()=>{const e=new S.Compartment;return{compartment:e,initialValue:t=>e.of(at(t)),reconfigure:async t=>e.reconfigure(await ct(t))}},xe=()=>document.createElement("div"),Me=()=>window.matchMedia("(prefers-color-scheme: dark)").matches,ut=e=>e===ee.Dark?!0:e===ee.Light?!1:Me(),oe=e=>{const t=[{suffix:"border-radius",default:"0.25rem"},{suffix:"color",default:"currentColor"},{suffix:"flex-direction",default:"column"},{suffix:"font-family",default:"inherit"},{suffix:"block-background-color",default:"#121212",light:"#f5f5f5"},{suffix:"block-background-color-on-hover",default:"#0f0f0f",light:"#e0e0e0"},{suffix:"block-max-height",default:"20rem"},{suffix:"block-padding",default:"0.5rem"},{suffix:"code-background-color",default:"var(--ink-internal-block-background-color)"},{suffix:"code-color",default:"inherit"},{suffix:"code-font-family",default:"'Monaco', Courier, monospace"},{suffix:"editor-font-size",default:"1em"},{suffix:"editor-line-height",default:"2em"},{suffix:"editor-padding",default:"0.5rem"},{suffix:"inline-padding",default:"0.125rem"},{suffix:"modal-position",default:"fixed"},{suffix:"syntax-atom-color",default:"#d19a66"},{suffix:"syntax-comment-color",default:"#abb2bf"},{suffix:"syntax-comment-font-style",default:"italic"},{suffix:"syntax-emphasis-color",default:"inherit"},{suffix:"syntax-emphasis-font-style",default:"italic"},{suffix:"syntax-hashtag-background-color",default:"#222",light:"#eee"},{suffix:"syntax-hashtag-color",default:"inherit"},{suffix:"syntax-heading-color",default:"inherit"},{suffix:"syntax-heading-font-weight",default:"600"},{suffix:"syntax-heading1-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading1-font-size",default:"1.6em"},{suffix:"syntax-heading1-font-weight",default:"600"},{suffix:"syntax-heading2-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading2-font-size",default:"1.5em"},{suffix:"syntax-heading2-font-weight",default:"600"},{suffix:"syntax-heading3-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading3-font-size",default:"1.4em"},{suffix:"syntax-heading3-font-weight",default:"600"},{suffix:"syntax-heading4-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading4-font-size",default:"1.3em"},{suffix:"syntax-heading4-font-weight",default:"600"},{suffix:"syntax-heading5-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading5-font-size",default:"1.2em"},{suffix:"syntax-heading5-font-weight",default:"600"},{suffix:"syntax-heading6-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading6-font-size",default:"1.1em"},{suffix:"syntax-heading6-font-weight",default:"600"},{suffix:"syntax-highlight-background-color",default:"#555555"},{suffix:"syntax-keyword-color",default:"#c678dd"},{suffix:"syntax-link-color",default:"inherit"},{suffix:"syntax-meta-color",default:"#abb2bf"},{suffix:"syntax-monospace-color",default:"var(--ink-internal-code-color)"},{suffix:"syntax-monospace-font-family",default:"var(--ink-internal-code-font-family)"},{suffix:"syntax-name-color",default:"#d19a66"},{suffix:"syntax-name-label-color",default:"#abb2bf"},{suffix:"syntax-name-property-color",default:"#96c0d8"},{suffix:"syntax-name-property-definition-color",default:"#e06c75"},{suffix:"syntax-name-variable-color",default:"#e06c75"},{suffix:"syntax-name-variable-definition-color",default:"#e5c07b"},{suffix:"syntax-name-variable-local-color",default:"#d19a66"},{suffix:"syntax-name-variable-special-color",default:"inherit"},{suffix:"syntax-number-color",default:"#d19a66"},{suffix:"syntax-operator-color",default:"#96c0d8"},{suffix:"syntax-processing-instruction-color",default:"#444444",light:"#bbbbbb"},{suffix:"syntax-punctuation-color",default:"#abb2bf"},{suffix:"syntax-strikethrough-color",default:"inherit"},{suffix:"syntax-strikethrough-text-decoration",default:"line-through"},{suffix:"syntax-string-color",default:"#98c379"},{suffix:"syntax-string-special-color",default:"inherit"},{suffix:"syntax-strong-color",default:"inherit"},{suffix:"syntax-strong-font-weight",default:"600"},{suffix:"syntax-url-color",default:"#aaaaaa",light:"#666666"},{suffix:"toolbar-group-spacing",default:"2rem"},{suffix:"toolbar-item-spacing",default:"0"}],n=!ut(e.options.interface.appearance);return t.map(r=>{const o=n&&r.light?r.light:r.default;return`--ink-internal-${r.suffix}: var(--ink-${r.suffix}, ${o});`})},ft=e=>[u.EditorView.theme({".cm-scroller":{fontFamily:"var(--ink-internal-font-family)"}},{dark:e})],mt=([e,t])=>e().extensions.map(r=>r.initialValue([e,t])),ne=async([e,t])=>await Promise.all(e().extensions.map(async r=>await r.reconfigure([e,t]))),gt=e=>{const t=new S.Compartment;return{compartment:t,initialValue:n=>t.of(e(n)),reconfigure:n=>t.reconfigure(e(n))}},pt=e=>{const t=new S.Compartment;return{compartment:t,initialValue:()=>t.of([]),reconfigure:n=>e(n,t)}},kt=()=>[dt(),...ht.map(e=>gt(e)),...bt.map(e=>pt(e))],ht=[([e])=>{const[t,n]=X(I(B.default,e().options));return n},([e])=>{const t=e().options.interface.appearance===le.dark,n=e().options.interface.appearance===le.auto;return ft(t||n&&Me())}],bt=[async([e],t)=>{const[n]=X(I(B.default,e().options));return n.length>0?t.reconfigure(await Promise.all(n)):t.reconfigure([])},async([e],t)=>{if(e().options.interface.autocomplete){const{autocomplete:n}=await Promise.resolve().then(()=>Zn);return t.reconfigure(n(e().options))}return t.reconfigure([])},async([e],t)=>{if(e().options.interface.images){const{images:n}=await Promise.resolve().then(()=>er);return t.reconfigure(n())}return t.reconfigure([])},async([e],t)=>{const{keybindings:n,trapTab:r}=e().options,o=r??n.tab,a=r??n.shiftTab;if(o||a){const{indentWithTab:s}=await Promise.resolve().then(()=>nr);return t.reconfigure(s({tab:o,shiftTab:a}))}return t.reconfigure([])},async([e],t)=>{const{options:n}=e();if(n.lists||n.interface.lists){const{lists:r}=await Promise.resolve().then(()=>ur);let o=!0,a=!0,s=!0;return typeof n.lists=="object"&&(o=typeof n.lists.bullet>"u"?!1:n.lists.bullet,a=typeof n.lists.number>"u"?!1:n.lists.number,s=typeof n.lists.task>"u"?!1:n.lists.task),t.reconfigure(r({bullet:o,number:a,task:s}))}return t.reconfigure([])},async([e],t)=>{if(e().options.placeholder){const{placeholder:n}=await Promise.resolve().then(()=>fr);return t.reconfigure(n(e().options.placeholder))}return t.reconfigure([])},async([e],t)=>{if(e().options.interface.readonly){const{readonly:n}=await Promise.resolve().then(()=>gr);return t.reconfigure(n())}return t.reconfigure([])},async([e],t)=>{if(e().options.search){const{search:n}=await Promise.resolve().then(()=>kr);return t.reconfigure(n())}return t.reconfigure([])},async([e],t)=>{if(e().options.interface.spellcheck){const{spellcheck:n}=await Promise.resolve().then(()=>br);return t.reconfigure(n())}return t.reconfigure([])},async([e],t)=>{if(e().options.vim){const{vim:n}=await Promise.resolve().then(()=>xr);return t.reconfigure(n())}return t.reconfigure([])}],xt=["Blockquote"],yt=u.Decoration.line({attributes:{class:"cm-blockquote"}}),vt=u.Decoration.line({attributes:{class:"cm-blockquote-open"}}),wt=u.Decoration.line({attributes:{class:"cm-blockquote-close"}}),$t=u.ViewPlugin.define(e=>({update:()=>_t(e)}),{decorations:e=>e.update()}),_t=e=>{const t=new S.RangeSetBuilder,n=q.syntaxTree(e.state);for(const r of e.visibleRanges)for(let o=r.from;o<r.to;){const a=e.state.doc.lineAt(o);n.iterate({enter({type:s,from:l,to:c}){if(s.name!=="Document"&&xt.includes(s.name)){t.add(a.from,a.from,yt);const d=e.state.doc.lineAt(l),f=e.state.doc.lineAt(c);return d.number===a.number&&t.add(a.from,a.from,vt),f.number===a.number&&t.add(a.from,a.from,wt),!1}},from:a.from,to:a.to}),o=a.to+1}return t.finish()},St=()=>[$t],Ct=["CodeBlock","FencedCode","HTMLBlock","CommentBlock"],Q={"data-enable-grammarly":"false","data-gramm":"false","data-grammarly-skip":"true",spellcheck:"false"},Et=u.Decoration.line({attributes:{...Q,class:"cm-codeblock"}}),Mt=u.Decoration.line({attributes:{...Q,class:"cm-codeblock-open"}}),Lt=u.Decoration.line({attributes:{...Q,class:"cm-codeblock-close"}}),Nt=u.Decoration.mark({attributes:{...Q,class:"cm-code"}}),Dt=u.Decoration.mark({attributes:{...Q,class:"cm-code cm-code-open"}}),jt=u.Decoration.mark({attributes:{...Q,class:"cm-code cm-code-close"}}),Tt=u.ViewPlugin.define(e=>({update:()=>At(e)}),{decorations:e=>e.update()}),At=e=>{const t=new S.RangeSetBuilder,n=q.syntaxTree(e.state);for(const r of e.visibleRanges)for(let o=r.from;o<r.to;){const a=e.state.doc.lineAt(o);let s;n.iterate({enter({type:l,from:c,to:d}){if(l.name!=="Document")if(Ct.includes(l.name)){t.add(a.from,a.from,Et);const f=e.state.doc.lineAt(c),x=e.state.doc.lineAt(d);return f.number===a.number&&t.add(a.from,a.from,Mt),x.number===a.number&&t.add(a.from,a.from,Lt),!1}else l.name==="InlineCode"?s={from:c,to:d,innerFrom:c,innerTo:d}:l.name==="CodeMark"&&(c===s.from?(s.innerFrom=d,t.add(c,d,Dt)):d===s.to&&(s.innerTo=c,t.add(s.innerFrom,s.innerTo,Nt),t.add(c,d,jt)))},from:a.from,to:a.to}),o=a.to+1}return t.finish()},Ht=()=>[Tt],Pt=()=>[u.EditorView.editorAttributes.of({class:"ink-mde-container"}),u.EditorView.contentAttributes.of({class:"ink-mde-editor-content"})],zt=()=>[...Pt()],Ot=()=>u.EditorView.lineWrapping,qt=()=>[q.syntaxHighlighting(q.HighlightStyle.define([{tag:g.tags.atom,color:"var(--ink-internal-syntax-atom-color)"},{tag:g.tags.meta,color:"var(--ink-internal-syntax-meta-color)"},{tag:g.tags.emphasis,color:"var(--ink-internal-syntax-emphasis-color)",fontStyle:"var(--ink-internal-syntax-emphasis-font-style)"},{tag:g.tags.strong,color:"var(--ink-internal-syntax-strong-color)",fontWeight:"var(--ink-internal-syntax-strong-font-weight)"},{tag:g.tags.strikethrough,color:"var(--ink-internal-syntax-strikethrough-color)",textDecoration:"var(--ink-internal-syntax-strikethrough-text-decoration)"},{tag:g.tags.comment,color:"var(--ink-internal-syntax-comment-color)",fontStyle:"var(--ink-internal-syntax-comment-font-style)"},{tag:g.tags.monospace,color:"var(--ink-internal-syntax-code-color)",fontFamily:"var(--ink-internal-syntax-code-font-family)"},{tag:g.tags.name,color:"var(--ink-internal-syntax-name-color)"},{tag:g.tags.labelName,color:"var(--ink-internal-syntax-name-label-color)"},{tag:g.tags.propertyName,color:"var(--ink-internal-syntax-name-property-color)"},{tag:g.tags.definition(g.tags.propertyName),color:"var(--ink-internal-syntax-name-property-definition-color)"},{tag:g.tags.variableName,color:"var(--ink-internal-syntax-name-variable-color)"},{tag:g.tags.definition(g.tags.variableName),color:"var(--ink-internal-syntax-name-variable-definition-color)"},{tag:g.tags.local(g.tags.variableName),color:"var(--ink-internal-syntax-name-variable-local-color)"},{tag:g.tags.special(g.tags.variableName),color:"var(--ink-internal-syntax-name-variable-special-color)"},{tag:g.tags.heading,color:"var(--ink-internal-syntax-heading-color)",fontWeight:"var(--ink-internal-syntax-heading-font-weight)"},{tag:g.tags.heading1,color:"var(--ink-internal-syntax-heading1-color)",fontSize:"var(--ink-internal-syntax-heading1-font-size)",fontWeight:"var(--ink-internal-syntax-heading1-font-weight)"},{tag:g.tags.heading2,color:"var(--ink-internal-syntax-heading2-color)",fontSize:"var(--ink-internal-syntax-heading2-font-size)",fontWeight:"var(--ink-internal-syntax-heading2-font-weight)"},{tag:g.tags.heading3,color:"var(--ink-internal-syntax-heading3-color)",fontSize:"var(--ink-internal-syntax-heading3-font-size)",fontWeight:"var(--ink-internal-syntax-heading3-font-weight)"},{tag:g.tags.heading4,color:"var(--ink-internal-syntax-heading4-color)",fontSize:"var(--ink-internal-syntax-heading4-font-size)",fontWeight:"var(--ink-internal-syntax-heading4-font-weight)"},{tag:g.tags.heading5,color:"var(--ink-internal-syntax-heading5-color)",fontSize:"var(--ink-internal-syntax-heading5-font-size)",fontWeight:"var(--ink-internal-syntax-heading5-font-weight)"},{tag:g.tags.heading6,color:"var(--ink-internal-syntax-heading6-color)",fontSize:"var(--ink-internal-syntax-heading6-font-size)",fontWeight:"var(--ink-internal-syntax-heading6-font-weight)"},{tag:g.tags.keyword,color:"var(--ink-internal-syntax-keyword-color)"},{tag:g.tags.number,color:"var(--ink-internal-syntax-number-color)"},{tag:g.tags.operator,color:"var(--ink-internal-syntax-operator-color)"},{tag:g.tags.punctuation,color:"var(--ink-internal-syntax-punctuation-color)"},{tag:g.tags.link,color:"var(--ink-internal-syntax-link-color)",wordBreak:"break-all"},{tag:g.tags.url,color:"var(--ink-internal-syntax-url-color)",wordBreak:"break-all"},{tag:g.tags.string,color:"var(--ink-internal-syntax-string-color)"},{tag:g.tags.special(g.tags.string),color:"var(--ink-internal-syntax-string-special-color)"},{tag:g.tags.processingInstruction,color:"var(--ink-internal-syntax-processing-instruction-color)"}]))],Bt=e=>{if(e.length>0)return ve(e)},Le=([e,t])=>{const{selections:n}=e().options;return S.EditorState.create({doc:e().options.doc,selection:Bt(n),extensions:[u.keymap.of([...K.defaultKeymap,...K.historyKeymap]),St(),Ht(),K.history(),zt(),Ot(),qt(),...mt([e,t])]})},Vt=([e,t],n)=>{const r=n?.getRootNode(),o=r?.nodeType===11?r:void 0,a=new u.EditorView({dispatch:s=>{const{options:l}=e(),c=s.newDoc.toString();l.hooks.beforeUpdate(c),a.update([s]),s.docChanged&&(t({...e(),doc:c}),l.hooks.afterUpdate(c))},root:o,state:Le([e,t])});return a},W={array:"[object Array]",object:"[object Object]",string:"[object String]",undefined:"[object Undefined]",window:"[object Window]"},Rt=e=>{if(Object.prototype.toString.call(e)===W.object)return`[object ${e.constructor.name}]`},F=(e,t)=>Rt(e)===t,Wt=(e,t)=>{const n=new WeakMap,r=(o,a)=>n.get(o)||(F(o,W.object)&&n.set(o,!0),F(a,W.undefined))?o:F(o,W.array)&&F(a,W.array)?[...a]:F(o,W.object)&&F(a,W.object)?Object.keys(o).reduce((s,l)=>(Object.hasOwnProperty.call(a,l)?s[l]=r(o[l],a[l]):s[l]=o[l],s),{}):a;return r(e,t)},Y=(e,t)=>Wt(e,t),It=([e,t],n)=>{t(Y(e(),{options:{doc:n}})),e().editor.setState(Le([e,t]))},Ft=([e])=>e().options,Qt=async([e,t],n)=>{const{workQueue:r}=e();return r.enqueue(async()=>{t(Y(e(),{options:n}));const o=await ne([e,t]);e().editor.dispatch({effects:o})})},Ne=(e,t={})=>{if(t.selections)return De(e,t.selections);if(t.selection)return ce(e,t.selection);if(t.at)return Ut(e,t.at)},Ut=(e,t)=>{const[n]=e;if(t===se.Start)return ce(e,{start:0,end:0});if(t===se.End){const r=n().editor.state.doc.length;return ce(e,{start:r,end:r})}},De=([e],t)=>{const{editor:n}=e();n.dispatch(n.state.update({selection:ve(t)}))},ce=(e,t)=>De(e,[t]),Kt=([e],t)=>{const{editor:n}=e();n.dispatch(n.state.update({changes:{from:0,to:n.state.doc.length,insert:t}}))},Xt=([e,t],{after:n,before:r,selection:o})=>{const{editor:a}=e(),s=o||fe([e,t]).pop()||{start:0,end:0},l=a.state.sliceDoc(s.start,s.end);te([e,t],`${r}${l}${n}`,s),Ne([e,t],{selections:[{start:s.start+r.length,end:s.end+r.length}]})},Yt=(e,t)=>{const n={callbacks:{fulfilled:[],rejected:[],settled:[]},status:"pending"},r=(l,{resolve:c,reject:d})=>()=>{try{const f=l(n.value);Promise.resolve(f).then(c,d)}catch(f){d(f)}},o=l=>{n.status==="pending"&&(n.status="rejected",n.value=l,n.callbacks.rejected.forEach(c=>c()),n.callbacks.settled.forEach(c=>c()))},a=l=>{n.status==="pending"&&(n.status="fulfilled",n.value=l,n.callbacks.fulfilled.forEach(c=>c()),n.callbacks.settled.forEach(c=>c()))},s=(l,c)=>new Promise((d,f)=>{n.status==="pending"&&(l&&n.callbacks.fulfilled.push(r(l,{resolve:d,reject:f})),c&&n.callbacks.rejected.push(r(c,{resolve:void 0,reject:f}))),n.status==="fulfilled"&&l&&r(l,{resolve:d,reject:f})(),n.status==="rejected"&&c&&r(c,{resolve:void 0,reject:f})()});return queueMicrotask(()=>{try{t(a,o)}catch(l){o(l)}}),{...e,[Symbol.toStringTag]:"awaitable",catch:s.bind(void 0,void 0),finally:l=>new Promise((c,d)=>{n.status==="pending"&&n.callbacks.settled.push(r(l,{resolve:c,reject:d})),n.status==="fulfilled"&&(l(),c(n.value)),n.status==="rejected"&&(l(),d(n.value))}),then:s}},je=e=>{const t={destroy:Ie.bind(void 0,e),focus:ae.bind(void 0,e),format:Se.bind(void 0,e),getDoc:et.bind(void 0,e),insert:te.bind(void 0,e),load:It.bind(void 0,e),options:Ft.bind(void 0,e),reconfigure:Qt.bind(void 0,e),select:Ne.bind(void 0,e),selections:fe.bind(void 0,e),update:Kt.bind(void 0,e),wrap:Xt.bind(void 0,e)};return Yt(t,(n,r)=>{try{const[o]=e;o().workQueue.enqueue(()=>n(t))}catch(o){r(o)}})},Zt=()=>{const e={queue:[],workload:0},t=async()=>{const n=e.queue.pop();n&&(await n(),e.workload--,await t())};return{enqueue:n=>new Promise((r,o)=>{const a=async()=>{try{await n(),r()}catch(s){o(s)}};e.queue.push(a),e.workload++,!(e.workload>1)&&t()})}},de=()=>{const e={doc:"",files:{clipboard:!1,dragAndDrop:!1,handler:()=>{},injectMarkup:!0,types:["image/*"]},hooks:{afterUpdate:()=>{},beforeUpdate:()=>{}},interface:{appearance:ee.Auto,attribution:!0,autocomplete:!1,images:!1,lists:!1,readonly:!1,spellcheck:!0,toolbar:!1},keybindings:{tab:!0,shiftTab:!0},lists:!1,placeholder:"",plugins:[],readability:!1,search:!0,selections:[],toolbar:{bold:!0,code:!0,codeBlock:!0,heading:!0,image:!0,italic:!0,link:!0,list:!0,orderedList:!0,quote:!0,taskList:!0,upload:!1},trapTab:void 0,vim:!1};return{doc:"",editor:{},extensions:kt(),options:e,root:xe(),target:xe(),workQueue:Zt()}},Jt=e=>Y(de(),e),me=(e,t={})=>{const[n,r]=m.createSignal(Jt({...t,doc:e.doc||"",options:e}));return[n,r]},ge=225,Gt=(e,t=ge)=>{const n=nn(e,t),r=rn(e),o=tn(e),a=en(e);return[n,r,o,a].join(" | ")},en=e=>`${on(e)} chars`,tn=e=>`${an(e)} lines`,nn=(e,t=ge)=>{const n=sn(e,t),r=Math.floor(n),o=Math.floor(n%1*60);return r===0?`${o}s read`:`${r}m ${o}s to read`},rn=e=>`${Te(e)} words`,on=e=>e.length,an=e=>e.split(/\n/).length,sn=(e,t=ge)=>Te(e)/t,Te=e=>{const t=e.replace(/[']/g,"").replace(/[^\w\d]+/g," ").trim();return t?t.split(/\s+/).length:0};var ln=i.template("<div class=ink-mde-readability><span>"),cn=i.template("<span>&nbsp;|"),dn=i.template('<div class=ink-mde-attribution><span>&nbsp;powered by <a class=ink-mde-attribution-link href=https://github.com/davidmyersdev/ink-mde rel="noopener noreferrer"target=_blank>ink-mde'),un=i.template("<div class=ink-mde-details><div class=ink-mde-container><div class=ink-mde-details-content><!$><!/><!$><!/><!$><!/>");const fn=()=>{const[e]=U();return(()=>{var t=i.getNextElement(un),n=t.firstChild,r=n.firstChild,o=r.firstChild,[a,s]=i.getNextMarker(o.nextSibling),l=a.nextSibling,[c,d]=i.getNextMarker(l.nextSibling),f=c.nextSibling,[x,k]=i.getNextMarker(f.nextSibling);return i.insert(r,i.createComponent(m.Show,{get when(){return e().options.readability},get children(){var y=i.getNextElement(ln),v=y.firstChild;return i.insert(v,()=>Gt(e().doc)),y}}),a,s),i.insert(r,i.createComponent(m.Show,{get when(){return i.memo(()=>!!e().options.readability)()&&e().options.interface.attribution},get children(){return i.getNextElement(cn)}}),c,d),i.insert(r,i.createComponent(m.Show,{get when(){return e().options.interface.attribution},get children(){return i.getNextElement(dn)}}),x,k),t})()},mn=".ink-drop-zone{align-items:center;background-color:#00000080;color:var(--ink-internal-color);display:flex;inset:0;justify-content:center;position:var(--ink-internal-modal-position);z-index:100}.ink-drop-zone:not(.visible){display:none}.ink-drop-zone-modal{background-color:var(--ink-internal-block-background-color);border-radius:var(--ink-internal-border-radius);box-sizing:border-box;height:100%;max-height:20rem;max-width:40rem;padding:1rem;position:relative;width:100%}.ink-drop-zone-hide{cursor:pointer;height:1.75rem;position:absolute;right:.25rem;top:.25rem;width:1.75rem}.ink-drop-zone-hide svg{background-color:var(--ink-internal-block-background-color)}.ink-drop-zone-droppable-area{align-items:center;border:.2rem dashed var(--ink-internal-color);border-radius:.125rem;box-sizing:border-box;display:flex;flex-direction:column;font-size:1.25em;gap:1rem;height:100%;justify-content:center;padding:1rem;text-align:center}.ink-drop-zone-file-preview{align-items:center;display:flex;flex-wrap:wrap;gap:.5rem;max-width:25.5rem}.ink-drop-zone-file-preview-image{border:.125rem solid #222;border-radius:.125rem;box-sizing:border-box;height:6rem;object-fit:cover;padding:.5rem;width:6rem}";var gn=i.template("<span>uploading files..."),pn=i.template('<div class=ink-drop-zone><style></style><div class=ink-drop-zone-modal><div class=ink-drop-zone-droppable-area><div class=ink-drop-zone-file-preview></div><!$><!/></div><div class=ink-drop-zone-hide><svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z">'),kn=i.template("<img class=ink-drop-zone-file-preview-image>"),hn=i.template("<span>drop files here");const bn=()=>{const[e,t]=m.createSignal(0),[n,r]=m.createSignal([]),[o,a]=m.createSignal(!1),[s,l]=m.createSignal(!1),[c,d]=U(),f=()=>{l(!1)},x=h=>{if(c().options.files.dragAndDrop){h.preventDefault(),h.stopPropagation();const w=h.dataTransfer;w?.files?j(w.files):(t(0),l(!1),r([]))}},k=h=>{c().options.files.dragAndDrop&&(h.preventDefault(),t(e()+1),l(!0))},y=h=>{c().options.files.dragAndDrop&&(h.preventDefault(),t(e()-1),e()===0&&l(!1))},v=h=>{c().options.files.dragAndDrop&&(h.preventDefault(),l(!0))},$=h=>{c().options.files.dragAndDrop&&(h.preventDefault(),t(0),l(!1))},L=h=>{if(c().options.files.clipboard){h.preventDefault();const w=h.clipboardData;w?.files&&w.files.length>0&&j(w.files)}},j=h=>{Array.from(h).forEach(w=>{r([...n(),w])}),a(!0),l(!0),Promise.resolve(c().options.files.handler(h)).then(w=>{if(c().options.files.injectMarkup&&w){const V=`![](${w})`;te([c,d],V)}}).finally(()=>{t(0),a(!1),l(!1),r([])})};return m.onMount(()=>{document.addEventListener("dragenter",k),document.addEventListener("dragleave",y),document.addEventListener("dragover",v),document.addEventListener("drop",$),c().root.addEventListener("paste",L)}),m.onCleanup(()=>{document.removeEventListener("dragenter",k),document.removeEventListener("dragleave",y),document.removeEventListener("dragover",v),document.removeEventListener("drop",$),c().root.removeEventListener("paste",L)}),(()=>{var h=i.getNextElement(pn),w=h.firstChild,V=w.nextSibling,H=V.firstChild,p=H.firstChild,P=p.nextSibling,[C,z]=i.getNextMarker(P.nextSibling),O=H.nextSibling;return i.setProperty(w,"textContent",mn),H.addEventListener("drop",x),i.insert(p,i.createComponent(m.For,{get each(){return n().slice(0,8)},children:_=>(()=>{var N=i.getNextElement(kn);return i.effect(E=>{var T=_.name,A=URL.createObjectURL(_);return T!==E.e&&i.setAttribute(N,"alt",E.e=T),A!==E.t&&i.setAttribute(N,"src",E.t=A),E},{e:void 0,t:void 0}),N})()})),i.insert(H,i.createComponent(m.Show,{get when(){return o()},get fallback(){return i.getNextElement(hn)},get children(){return i.getNextElement(gn)}}),C,z),O.$$click=f,i.effect(()=>h.classList.toggle("visible",!!s())),i.runHydrationEvents(),h})()};i.delegateEvents(["click"]);const xn=e=>{const[t,n]=U(),r=Vt([t,n],e.target),{workQueue:o}=t();return n(Y(t(),{editor:r})),o.enqueue(async()=>{const a=await ne([t,n]);r.dispatch({effects:a})}),r.dom};var yn=i.template("<button class=ink-button type=button>");const M=e=>(()=>{var t=i.getNextElement(yn);return t.$$click=n=>e.onclick(n),i.insert(t,()=>e.children),i.runHydrationEvents(),t})();i.delegateEvents(["click"]);const vn=".ink-mde .ink-mde-toolbar{background-color:var(--ink-internal-block-background-color);color:inherit;display:flex;flex-shrink:0;overflow-x:auto;padding:.25rem}.ink-mde .ink-mde-toolbar .ink-mde-container{display:flex;gap:var(--ink-internal-toolbar-group-spacing)}.ink-mde .ink-mde-toolbar-group{display:flex;gap:var(--ink-internal-toolbar-item-spacing)}.ink-mde .ink-mde-toolbar .ink-button{align-items:center;background:none;border:none;border-radius:var(--ink-internal-border-radius);color:inherit;cursor:pointer;display:flex;height:2.25rem;justify-content:center;padding:.4rem;width:2.25rem}.ink-mde .ink-mde-toolbar .ink-button:hover{background-color:var(--ink-internal-block-background-color-on-hover)}.ink-mde .ink-mde-toolbar .ink-button>*{align-items:center;display:flex;height:100%}";var wn=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M6 4V10M6 16V10M6 10H14M14 10V4M14 10V16">'),$n=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-width=1.5 stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M6.5 10H10.5C12.1569 10 13.5 11.3431 13.5 13C13.5 14.6569 12.1569 16 10.5 16H6.5V4H9.5C11.1569 4 12.5 5.34315 12.5 7C12.5 8.65686 11.1569 10 9.5 10">'),_n=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M11 4L9 16M13 4H9M7 16H11">'),J=i.template("<div class=ink-mde-toolbar-group><!$><!/><!$><!/><!$><!/>"),Sn=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M2.00257 16H17.9955M2.00055 4H18M7 10H18.0659M2 8.5V11.4999C2.4 11.5 2.5 11.5 2.5 11.5V11V10.5M4 8.5V11.4999H4.5V11V10.5">'),Cn=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M13 4L7 16"></path><path d="M5 7L2 10L5 13"></path><path d="M15 7L18 10L15 13">'),En=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M7 4L8 6">'),Mn=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M7 16H17.8294"></path><path d="M2 16H4"></path><path d="M7 10H17.8294"></path><path d="M2 10H4"></path><path d="M7 4H17.8294"></path><path d="M2 4H4">'),Ln=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M7 16H18"></path><path d="M2 17.0242C2.48314 17.7569 3.94052 17.6154 3.99486 16.7919C4.05315 15.9169 3.1975 16.0044 2.99496 16.0044M2.0023 14.9758C2.48544 14.2431 3.94282 14.3846 3.99716 15.2081C4.05545 16.0831 3.1998 16.0002 2.99726 16.0002"></path><path d="M7 10H18"></path><path d="M2.00501 11.5H4M2.00193 8.97562C2.48449 8.24319 3.9401 8.38467 3.99437 9.20777C4.05259 10.0825 2.04342 10.5788 2 11.4996"></path><path d="M7 4H18"></path><path d="M2 5.5H4M2.99713 5.49952V2.5L2.215 2.93501">'),Nn=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M7 16H17.8294"></path><path d="M5 15L3 17L2 16"></path><path d="M7 10H17.8294"></path><path d="M5 9L3 11L2 10"></path><path d="M7 4H17.8294"></path><path d="M5 3L3 5L2 4">'),Dn=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M9.12127 10.881C10.02 11.78 11.5237 11.7349 12.4771 10.7813L15.2546 8.00302C16.2079 7.04937 16.253 5.54521 15.3542 4.6462C14.4555 3.74719 12.9512 3.79174 11.9979 4.74539L10.3437 6.40007M10.8787 9.11903C9.97997 8.22002 8.47626 8.26509 7.52288 9.21874L4.74545 11.997C3.79208 12.9506 3.74701 14.4548 4.64577 15.3538C5.54452 16.2528 7.04876 16.2083 8.00213 15.2546L9.65633 13.5999">'),jn=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><rect x=2 y=4 width=16 height=12 rx=1></rect><path d="M7.42659 7.67597L13.7751 13.8831M2.00208 12.9778L7.42844 7.67175"></path><path d="M11.9119 12.0599L14.484 9.54443L17.9973 12.9785"></path><path d="M10.9989 7.95832C11.551 7.95832 11.9986 7.52072 11.9986 6.98092C11.9986 6.44113 11.551 6.00354 10.9989 6.00354C10.4468 6.00354 9.99921 6.44113 9.99921 6.98092C9.99921 7.52072 10.4468 7.95832 10.9989 7.95832Z">'),Tn=i.template('<svg viewBox="0 0 20 20"fill=none stroke=currentColor stroke-miterlimit=5 stroke-linecap=round stroke-linejoin=round><path d="M10 13V4M10 4L13 7M10 4L7 7"></path><path d="M2 13V15C2 15.5523 2.44772 16 3 16H17C17.5523 16 18 15.5523 18 15V13">'),An=i.template("<input type=file>"),Hn=i.template("<div class=ink-mde-toolbar><style></style><div class=ink-mde-container><!$><!/><!$><!/><!$><!/><!$><!/>");const Pn=()=>{const[e,t]=U(),[n,r]=m.createSignal(),o=l=>{Se([e,t],l),ae([e,t])},a=l=>{const c=l.target;c?.files&&Promise.resolve(e().options.files.handler(c.files)).then(d=>{if(d){const f=`![](${d})`;te([e,t],f),ae([e,t])}})},s=()=>{n()?.click()};return(()=>{var l=i.getNextElement(Hn),c=l.firstChild,d=c.nextSibling,f=d.firstChild,[x,k]=i.getNextMarker(f.nextSibling),y=x.nextSibling,[v,$]=i.getNextMarker(y.nextSibling),L=v.nextSibling,[j,h]=i.getNextMarker(L.nextSibling),w=j.nextSibling,[V,H]=i.getNextMarker(w.nextSibling);return i.setProperty(c,"textContent",vn),i.insert(d,i.createComponent(m.Show,{get when(){return e().options.toolbar.heading||e().options.toolbar.bold||e().options.toolbar.italic},get children(){var p=i.getNextElement(J),P=p.firstChild,[C,z]=i.getNextMarker(P.nextSibling),O=C.nextSibling,[_,N]=i.getNextMarker(O.nextSibling),E=_.nextSibling,[T,A]=i.getNextMarker(E.nextSibling);return i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.heading},get children(){return i.createComponent(M,{onclick:()=>o(b.Heading),get children(){return i.getNextElement(wn)}})}}),C,z),i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.bold},get children(){return i.createComponent(M,{onclick:()=>o(b.Bold),get children(){return i.getNextElement($n)}})}}),_,N),i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.italic},get children(){return i.createComponent(M,{onclick:()=>o(b.Italic),get children(){return i.getNextElement(_n)}})}}),T,A),p}}),x,k),i.insert(d,i.createComponent(m.Show,{get when(){return e().options.toolbar.quote||e().options.toolbar.codeBlock||e().options.toolbar.code},get children(){var p=i.getNextElement(J),P=p.firstChild,[C,z]=i.getNextMarker(P.nextSibling),O=C.nextSibling,[_,N]=i.getNextMarker(O.nextSibling),E=_.nextSibling,[T,A]=i.getNextMarker(E.nextSibling);return i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.quote},get children(){return i.createComponent(M,{onclick:()=>o(b.Quote),get children(){return i.getNextElement(Sn)}})}}),C,z),i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.codeBlock},get children(){return i.createComponent(M,{onclick:()=>o(b.CodeBlock),get children(){return i.getNextElement(Cn)}})}}),_,N),i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.code},get children(){return i.createComponent(M,{onclick:()=>o(b.Code),get children(){return i.getNextElement(En)}})}}),T,A),p}}),v,$),i.insert(d,i.createComponent(m.Show,{get when(){return e().options.toolbar.list||e().options.toolbar.orderedList||e().options.toolbar.taskList},get children(){var p=i.getNextElement(J),P=p.firstChild,[C,z]=i.getNextMarker(P.nextSibling),O=C.nextSibling,[_,N]=i.getNextMarker(O.nextSibling),E=_.nextSibling,[T,A]=i.getNextMarker(E.nextSibling);return i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.list},get children(){return i.createComponent(M,{onclick:()=>o(b.List),get children(){return i.getNextElement(Mn)}})}}),C,z),i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.orderedList},get children(){return i.createComponent(M,{onclick:()=>o(b.OrderedList),get children(){return i.getNextElement(Ln)}})}}),_,N),i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.taskList},get children(){return i.createComponent(M,{onclick:()=>o(b.TaskList),get children(){return i.getNextElement(Nn)}})}}),T,A),p}}),j,h),i.insert(d,i.createComponent(m.Show,{get when(){return e().options.toolbar.link||e().options.toolbar.image||e().options.toolbar.upload},get children(){var p=i.getNextElement(J),P=p.firstChild,[C,z]=i.getNextMarker(P.nextSibling),O=C.nextSibling,[_,N]=i.getNextMarker(O.nextSibling),E=_.nextSibling,[T,A]=i.getNextMarker(E.nextSibling);return i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.link},get children(){return i.createComponent(M,{onclick:()=>o(b.Link),get children(){return i.getNextElement(Dn)}})}}),C,z),i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.image},get children(){return i.createComponent(M,{onclick:()=>o(b.Image),get children(){return i.getNextElement(jn)}})}}),_,N),i.insert(p,i.createComponent(m.Show,{get when(){return e().options.toolbar.upload},get children(){return i.createComponent(M,{onclick:s,get children(){return[i.getNextElement(Tn),(()=>{var Z=i.getNextElement(An);return i.use(r,Z),Z.addEventListener("change",a),Z.style.setProperty("display","none"),Z})()]}})}}),T,A),p}}),V,H),l})()},zn=".ink-mde{border:2px solid var(--ink-internal-block-background-color);border-radius:var(--ink-internal-border-radius);color:var(--ink-internal-color, inherit);display:flex;flex-direction:var(--ink-internal-flex-direction, column);font-family:var(--ink-internal-font-family)}.ink-mde .cm-cursor{border-left-color:var(--ink-internal-color, inherit);margin-left:0}.ink-mde .cm-tooltip{background-color:var(--ink-internal-block-background-color);border-radius:var(--ink-internal-border-radius);font-family:inherit;padding:.25rem}.ink-mde .cm-tooltip.cm-tooltip-autocomplete ul{font-family:inherit}.ink-mde .cm-tooltip.cm-tooltip-autocomplete ul li.ink-tooltip-option{border-radius:var(--ink-internal-border-radius);padding:.25rem}.ink-mde .cm-tooltip.cm-tooltip-autocomplete ul li.ink-tooltip-option[aria-selected]{background-color:#96969640}.ink-mde .cm-completionLabel{font-family:inherit}.ink-mde,.ink-mde *{box-sizing:border-box}.ink-mde,.ink-mde .ink-mde-editor{display:flex;flex-direction:column;flex-grow:1;flex-shrink:1;min-height:0}.ink-mde .ink-mde-editor{overflow:auto;padding:.5rem}.ink-mde .ink-mde-toolbar,.ink-mde .ink-mde-details{display:flex;flex-grow:0;flex-shrink:0}.ink-mde .ink-mde-details{background-color:var(--ink-internal-block-background-color);display:flex;padding:.5rem}.ink-mde .ink-mde-details-content{color:inherit;display:flex;filter:brightness(.75);flex-wrap:wrap;font-size:.75em;justify-content:flex-end}.ink-mde .ink-mde-attribution{display:flex;justify-content:flex-end}.ink-mde .ink-mde-attribution-link{color:currentColor;font-weight:600;text-decoration:none}.ink-mde .ink-mde-container{margin-left:auto;margin-right:auto;width:100%}.ink-mde .ink-mde-search-panel{background-color:var(--ink-internal-block-background-color);border-radius:.25rem;padding:.25rem;position:absolute;right:.25rem;top:.25rem;width:clamp(10rem,30%,100%)}.ink-mde .ink-mde-search-panel:focus-within{outline-color:#6495ed;outline-style:solid}.ink-mde .ink-mde-search-input{background-color:transparent;border:none;border-radius:.25rem;color:inherit;font-size:inherit;outline:none;width:100%}.ink-mde .cm-editor{display:flex;flex-direction:column;position:relative}.ink-mde .cm-panels{background-color:unset;border:unset;z-index:10}.ink-mde .cm-searchMatch{background-color:#6495ed50}.ink-mde .cm-searchMatch-selected{background-color:#6495edcc}.ink-mde .cm-scroller{align-items:flex-start;display:flex;font-family:var(--ink-internal-font-family);font-size:var(--ink-internal-editor-font-size);line-height:var(--ink-internal-editor-line-height);overflow-x:auto;position:relative}.ink-mde .cm-content{display:block;flex-grow:2;flex-shrink:0;margin:0;outline:none;padding:0;white-space:nowrap}.ink-mde .cm-lineWrapping{display:flex;flex-direction:column;flex-shrink:1;overflow-wrap:unset;word-break:break-word;white-space:pre-wrap;width:100%;overflow-x:hidden}.ink-mde .cm-line .cm-code,.ink-mde .cm-line .cm-blockquote{word-break:break-all}.ink-mde .cm-line{font-family:var(--ink-internal-font-family);padding:0}.ink-mde .cm-line span{display:inline}.ink-mde .cm-line.cm-blockquote{background-color:var(--ink-internal-block-background-color);border-left:.25rem solid currentColor;padding:0 var(--ink-internal-block-padding)}.ink-mde .cm-line.cm-blockquote.cm-blockquote-open{border-top-left-radius:var(--ink-internal-border-radius);border-top-right-radius:var(--ink-internal-border-radius);padding-top:var(--ink-internal-block-padding)}.ink-mde .cm-line.cm-blockquote.cm-blockquote-close{border-bottom-left-radius:var(--ink-internal-border-radius);border-bottom-right-radius:var(--ink-internal-border-radius);padding-bottom:var(--ink-internal-block-padding)}.ink-mde .cm-line.cm-codeblock{background-color:var(--ink-internal-block-background-color);font-family:var(--ink-internal-code-font-family);padding:0 var(--ink-internal-block-padding)}.ink-mde .cm-line.cm-codeblock.cm-codeblock-open{border-radius:var(--ink-internal-border-radius) var(--ink-internal-border-radius) 0 0;padding-top:var(--ink-internal-block-padding)}.ink-mde .cm-line.cm-codeblock.cm-codeblock-close{border-radius:0 0 var(--ink-internal-border-radius) var(--ink-internal-border-radius);padding-bottom:var(--ink-internal-block-padding)}.ink-mde .cm-line .cm-code{background-color:var(--ink-internal-block-background-color);font-family:var(--ink-internal-code-font-family);padding:var(--ink-internal-inline-padding) 0}.ink-mde .cm-line .cm-code.cm-code-open{border-radius:var(--ink-internal-border-radius) 0 0 var(--ink-internal-border-radius);padding-left:var(--ink-internal-inline-padding)}.ink-mde .cm-line .cm-code.cm-code-close{border-radius:0 var(--ink-internal-border-radius) var(--ink-internal-border-radius) 0;padding-right:var(--ink-internal-inline-padding)}.ink-mde .cm-image-backdrop{background-color:var(--ink-internal-block-background-color)}.ink-mde .ink-mde-block-widget-container{padding:.5rem 0}.ink-mde .ink-mde-block-widget{background-color:var(--ink-internal-block-background-color);border-radius:var(--ink-internal-border-radius);padding:var(--ink-internal-block-padding)}";var On=i.template("<style> ");const qn=()=>{const[e,t]=U(),[n,r]=m.createSignal(oe(e()));return m.createEffect(()=>{r(oe(e()))}),m.onMount(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)"),a=s=>{const{editor:l,root:c,workQueue:d}=e();c.isConnected?d.enqueue(async()=>{const f=await ne([e,t]);l.dispatch({effects:f}),r(oe(e()))}):o.removeEventListener("change",a)};o.addEventListener("change",a)}),(()=>{var o=i.getNextElement(On),a=o.firstChild;return i.effect(()=>i.setProperty(a,"data",`.ink {
  ${n().join(`
  `)}
}
${zn}`)),o})()};var Bn=i.template('<div class="ink ink-mde"><!$><!/><!$><!/><!$><!/><div class=ink-mde-editor></div><!$><!/>');const Vn=e=>{const[t,n]=U(),r=o=>{n(Y(t(),{root:o}))};return(()=>{var o=i.getNextElement(Bn),a=o.firstChild,[s,l]=i.getNextMarker(a.nextSibling),c=s.nextSibling,[d,f]=i.getNextMarker(c.nextSibling),x=d.nextSibling,[k,y]=i.getNextMarker(x.nextSibling),v=k.nextSibling,$=v.nextSibling,[L,j]=i.getNextMarker($.nextSibling);return i.use(r,o),i.spread(o,i.mergeProps(We),!1,!0),i.insert(o,i.createComponent(qn,{}),s,l),i.insert(o,i.createComponent(m.Show,{get when(){return t().options.files.clipboard||t().options.files.dragAndDrop},get children(){return i.createComponent(bn,{})}}),d,f),i.insert(o,i.createComponent(m.Show,{get when(){return t().options.interface.toolbar},get children(){return i.createComponent(Pn,{})}}),k,y),i.insert(v,i.createComponent(xn,{get target(){return e.target}})),i.insert(o,i.createComponent(m.Show,{get when(){return t().options.readability||t().options.interface.attribution},get children(){return i.createComponent(fn,{store:[t,n]})}}),L,j),i.runHydrationEvents(),o})()},Ae=m.createContext([()=>de(),e=>typeof e=="function"?e(de()):e]),Rn=e=>i.createComponent(Ae.Provider,{get value(){return e.store},get children(){return e.children}}),U=()=>m.useContext(Ae),He=e=>i.createComponent(Rn,{get store(){return e.store},get children(){return i.createComponent(Vn,{get store(){return e.store},get target(){return e.target}})}});var Wn=i.template("<div class=ink-mde-textarea>");const In=e=>e,Fn=e=>e,Qn=e=>e,Pe=(e,t={})=>{const n=me(t);return qe(),i.hydrate(()=>i.createComponent(He,{store:n,target:e}),e),je(n)},ze=(e,t={})=>e.querySelector(Re)?Pe(e,t):pe(e,t),Oe=({key:e="",type:t,value:n})=>new Proxy({key:e,type:t||"default"},{get:(r,o,a)=>o==="value"&&!r[o]?(r.value=n(),Ce(r.value)?r.value.then(s=>r.value=s):r.value):r[o]}),Un=Oe,pe=(e,t={})=>{const n=me(t);return i.render(()=>i.createComponent(He,{store:n,target:e}),e),je(n)},Kn=(e={})=>(me(e),""),qe=()=>{let e,t;e=window._$HY||(window._$HY={events:[],completed:new WeakSet,r:{}}),t=n=>n&&n.hasAttribute&&(n.hasAttribute("data-hk")?n:t(n.host&&n.host instanceof Node?n.host:n.parentNode)),["click","input"].forEach(n=>document.addEventListener(n,r=>{let o=r.composedPath&&r.composedPath()[0]||r.target,a=t(o);a&&!e.completed.has(a)&&e.events.push([a,r])})),e.init=(n,r)=>{e.r[n]=[new Promise((o,a)=>r=o),r]},e.set=(n,r,o)=>{(o=e.r[n])&&o[1](r),e.r[n]=[r]},e.unset=n=>{delete e.r[n]},e.load=(n,r)=>{if(r=e.r[n])return r[0]}},Xn=(e,t={})=>{const n=i.getNextElement(Wn),r=e.value;e.after(n),e.style.display="none";const o=pe(n,{doc:r,...t});return e.form&&e.form.addEventListener("submit",()=>{e.value=o.getDoc()}),o},Yn=e=>{const[t,n]=X(I(B.completion,e));return[be.autocompletion({defaultKeymap:!0,icons:!1,override:n,optionClass:()=>"ink-tooltip-option"}),be.closeBrackets()]},Zn=Object.freeze(Object.defineProperty({__proto__:null,autocomplete:Yn},Symbol.toStringTag,{value:"Module"}));class Jn extends u.WidgetType{url;constructor({url:t}){super(),this.url=t}eq(t){return t.url===this.url}toDOM(){const t=document.createElement("div"),n=t.appendChild(document.createElement("div")),r=n.appendChild(document.createElement("figure")),o=r.appendChild(document.createElement("img"));return t.setAttribute("aria-hidden","true"),t.className="cm-image-container",n.className="cm-image-backdrop",r.className="cm-image-figure",o.className="cm-image-img",o.src=this.url,t.style.paddingBottom="0.5rem",t.style.paddingTop="0.5rem",n.classList.add("cm-image-backdrop"),n.style.borderRadius="var(--ink-internal-border-radius)",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.overflow="hidden",n.style.maxWidth="100%",r.style.margin="0",o.style.display="block",o.style.maxHeight="var(--ink-internal-block-max-height)",o.style.maxWidth="100%",o.style.width="100%",t}}const Gn=()=>{const e=/!\[.*?\]\((?<url>.*?)\)/,t=o=>u.Decoration.widget({widget:new Jn(o),side:-1,block:!0}),n=o=>{const a=[];return q.syntaxTree(o).iterate({enter:({type:s,from:l,to:c})=>{if(s.name==="Image"){const d=e.exec(o.doc.sliceString(l,c));d&&d.groups&&d.groups.url&&a.push(t({url:d.groups.url}).range(o.doc.lineAt(l).from))}}}),a.length>0?S.RangeSet.of(a):u.Decoration.none};return[S.StateField.define({create(o){return n(o)},update(o,a){return a.docChanged?n(a.state):o.map(a.changes)},provide(o){return u.EditorView.decorations.from(o)}})]},er=Object.freeze(Object.defineProperty({__proto__:null,images:Gn},Symbol.toStringTag,{value:"Module"})),tr=({tab:e=!0,shiftTab:t=!0}={})=>u.keymap.of([{key:"Tab",run:e?K.indentMore:void 0},{key:"Shift-Tab",run:t?K.indentLess:void 0}]),nr=Object.freeze(Object.defineProperty({__proto__:null,indentWithTab:tr},Symbol.toStringTag,{value:"Module"})),re=e=>{const t=n=>e.eq?e.eq(n):e.id?e.id===n.id:!1;return{compare:n=>t(n),coordsAt:()=>null,destroy:()=>{},eq:n=>t(n),estimatedHeight:-1,ignoreEvent:()=>!0,lineBreaks:0,toDOM:()=>document.createElement("span"),updateDOM:()=>!1,...e}},ie=2,rr=()=>re({toDOM:()=>{const e=document.createElement("span");e.className="ink-mde-indent",e.style.width="2rem",e.style.textDecoration="none",e.style.display="inline-flex";const t=document.createElement("span");return t.className="ink-mde-indent-marker",t.innerHTML="&nbsp;",e.appendChild(t),e}}),ke=()=>{const e=document.createElement("label");return e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex","-1"),e.className="ink-mde-list-marker",e.style.minWidth="2rem",e},or=e=>re({eq:t=>t.isChecked===e,ignoreEvent:()=>!1,isChecked:e,toDOM:()=>{const t=ke(),n=document.createElement("input");return n.setAttribute("aria-hidden","true"),n.setAttribute("tabindex","-1"),n.className="ink-mde-task-marker",n.type="checkbox",n.checked=e,t.classList.add("ink-mde-task"),t.appendChild(n),t}}),ir=()=>re({toDOM:()=>{const e=ke();return e.setAttribute("inert","true"),e.innerHTML="&bull;",e}}),ar=e=>re({toDOM:()=>{const t=ke(),n=document.createElement("span");return t.setAttribute("inert","true"),t.appendChild(n),n.setAttribute("aria-hidden","true"),n.setAttribute("tabindex","-1"),n.className="ink-mde-number-marker",n.innerHTML=`${e}`,t}}),he=(e,{from:t,to:n,type:r})=>{if(r.name==="Blockquote")return!1;if(r.name!=="ListMark")return;const a=e.doc.lineAt(t).from,s=e.sliceDoc(t,n),l=t,c=n,d=e.sliceDoc(c,c+1)===" ",f=l-a;if(!d)return;const x=Math.floor(f/ie),k=[];for(const y of Array(x).keys()){const v=a+y*ie,$=v+ie,L=u.Decoration.replace({widget:rr()}).range(v,$);k.push(L)}return{indentLevel:x,indentation:f,lineStart:a,marker:s,markerEnd:c,markerStart:l,spacerDecorations:k}},sr=()=>{const e=n=>{const r=[],o=[];return q.syntaxTree(n).iterate({enter:a=>{const s=he(n,a);if(!s)return s;const{indentLevel:l,lineStart:c,marker:d,markerEnd:f,markerStart:x,spacerDecorations:k}=s;if(!["-","*"].includes(d))return;const y=u.Decoration.line({attributes:{class:"ink-mde-list ink-mde-bullet-list",style:`--indent-level: ${l}`}}).range(c);o.push(y),o.push(...k),r.push(...k);const v=f+1,$=u.Decoration.replace({widget:ir()}).range(x,v);o.push($),r.push($)}}),[u.Decoration.set(o,!0),u.Decoration.set(r,!0)]};return[S.StateField.define({create(n){return e(n)},update(n,{state:r}){return e(r)},provide(n){return[u.EditorView.decorations.of(o=>{const[a,s]=o.state.field(n);return a}),u.EditorView.atomicRanges.of(o=>{const[a,s]=o.state.field(n);return s})]}})]},lr=()=>{const e=n=>{const r=[],o=[];return q.syntaxTree(n).iterate({enter:a=>{const s=he(n,a);if(!s)return s;const{indentLevel:l,lineStart:c,marker:d,markerEnd:f,markerStart:x,spacerDecorations:k}=s;if(["-","*"].includes(d))return;const y=u.Decoration.line({attributes:{class:"ink-mde-list ink-mde-number-list",style:`--indent-level: ${l}`}}).range(c);o.push(y),o.push(...k),r.push(...k);const v=f+1,$=u.Decoration.replace({widget:ar(d)}).range(x,v);o.push($),r.push($)}}),[u.Decoration.set(o,!0),u.Decoration.set(r,!0)]};return[S.StateField.define({create(n){return e(n)},update(n,{state:r}){return e(r)},provide(n){return[u.EditorView.decorations.of(o=>{const[a,s]=o.state.field(n);return a}),u.EditorView.atomicRanges.of(o=>{const[a,s]=o.state.field(n);return s})]}})]},cr=()=>{const e=r=>{const o=[],a=[];return q.syntaxTree(r).iterate({enter:s=>{const l=he(r,s);if(!l)return l;const{indentLevel:c,lineStart:d,marker:f,markerEnd:x,markerStart:k,spacerDecorations:y}=l;if(!["-","*"].includes(f))return;const v=x+1,$=v+3,L=r.sliceDoc(v,$);if(!["[ ]","[x]"].includes(L))return;const j=$+1;if(!(r.sliceDoc($,j)===" "))return;const w=L==="[x]",V=u.Decoration.line({attributes:{class:`ink-mde-list ink-mde-task-list ${w?"ink-mde-task-checked":"ink-mde-task-unchecked"}`,style:`--indent-level: ${c}`}}).range(d);a.push(V),a.push(...y),o.push(...y);const H=u.Decoration.replace({widget:or(w)}).range(k,j);a.push(H),o.push(H)}}),[u.Decoration.set(a,!0),u.Decoration.set(o,!0)]},t=u.ViewPlugin.define(()=>({}),{eventHandlers:{mousedown:(r,o)=>{const s=r.target.closest(".ink-mde-list-marker")?.querySelector(".ink-mde-task-marker");if(s){const l=o.posAtDOM(s),c=l-4,d=l-1,f=o.state.sliceDoc(c,d);return f==="[ ]"&&o.dispatch({changes:{from:c,to:d,insert:"[x]"}}),f==="[x]"&&o.dispatch({changes:{from:c,to:d,insert:"[ ]"}}),!0}}}}),n=S.StateField.define({create(r){return e(r)},update(r,{state:o}){return e(o)},provide(r){return[u.EditorView.decorations.of(a=>{const[s,l]=a.state.field(r);return s}),u.EditorView.atomicRanges.of(a=>{const[s,l]=a.state.field(r);return l})]}});return[t,n]},dr=e=>[e.task?cr():[],e.bullet?sr():[],e.number?lr():[],u.EditorView.theme({":where(.ink-mde-indent)":{display:"inline-flex",justifyContent:"center"},":where(.ink-mde-indent-marker)":{borderLeft:"1px solid var(--ink-internal-syntax-processing-instruction-color)",bottom:"0",overflow:"hidden",position:"absolute",top:"0",width:"0"},":where(.ink-mde-list)":{paddingLeft:"calc(var(--indent-level) * 2rem + 2rem) !important",position:"relative",textIndent:"calc((var(--indent-level) * 2rem + 2rem) * -1)"},":where(.ink-mde-list *)":{textIndent:"0"},":where(.ink-mde-list-marker)":{alignItems:"center",color:"var(--ink-internal-syntax-processing-instruction-color)",display:"inline-flex",justifyContent:"center",minWidth:"2rem"},":where(.ink-mde-task-marker)":{cursor:"pointer",margin:"0",scale:"1.2",transformOrigin:"center center"},":where(.ink-mde-task-list.ink-mde-task-checked)":{textDecoration:"line-through",textDecorationColor:"var(--ink-internal-syntax-processing-instruction-color)"}})],ur=Object.freeze(Object.defineProperty({__proto__:null,lists:dr},Symbol.toStringTag,{value:"Module"})),fr=Object.freeze(Object.defineProperty({__proto__:null,placeholder:u.placeholder},Symbol.toStringTag,{value:"Module"})),mr=()=>S.EditorState.readOnly.of(!0),gr=Object.freeze(Object.defineProperty({__proto__:null,readonly:mr},Symbol.toStringTag,{value:"Module"})),pr=()=>[R.search({top:!0,createPanel:e=>{let t=R.getSearchQuery(e.state);const n=document.createElement("div"),r=document.createElement("input");n.setAttribute("class","ink-mde-search-panel"),r.setAttribute("attr:main-field","true"),r.setAttribute("class","ink-mde-search-input"),r.setAttribute("type","text"),r.setAttribute("value",t.search),n.appendChild(r);const o=s=>{if(u.runScopeHandlers(e,s,"search-panel"))return s.preventDefault();s.code==="Enter"&&(s.preventDefault(),s.shiftKey?R.findPrevious(e):R.findNext(e))},a=s=>{const{value:l}=s.target;t=new R.SearchQuery({search:l}),e.dispatch({effects:R.setSearchQuery.of(t)})};return r.addEventListener("input",a),r.addEventListener("keydown",o),{dom:n,mount:()=>{r.focus()},top:!0}}}),u.keymap.of(R.searchKeymap)],kr=Object.freeze(Object.defineProperty({__proto__:null,search:pr},Symbol.toStringTag,{value:"Module"})),hr=()=>u.EditorView.contentAttributes.of({spellcheck:"true"}),br=Object.freeze(Object.defineProperty({__proto__:null,spellcheck:hr},Symbol.toStringTag,{value:"Module"})),xr=Object.freeze(Object.defineProperty({__proto__:null,vim:Be.vim},Symbol.toStringTag,{value:"Module"}));exports.appearanceTypes=le;exports.default=ze;exports.defineConfig=In;exports.defineOptions=Fn;exports.definePlugin=Qn;exports.hydrate=Pe;exports.ink=ze;exports.inkPlugin=Oe;exports.plugin=Un;exports.pluginTypes=B;exports.render=pe;exports.renderToString=Kn;exports.solidPrepareForHydration=qe;exports.wrap=Xn;
//# sourceMappingURL=client.cjs.map

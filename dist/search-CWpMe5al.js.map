{"version":3,"file":"search-CWpMe5al.js","sources":["../src/editor/extensions/search.tsx"],"sourcesContent":["import {\n  SearchQuery,\n  findNext,\n  findPrevious,\n  getSearchQuery,\n  search as searchExtension,\n  searchKeymap,\n  setSearchQuery,\n} from '@codemirror/search'\nimport { keymap, runScopeHandlers } from '@codemirror/view'\n\nexport const search = () => {\n  return [\n    searchExtension({\n      top: true,\n      createPanel: (view) => {\n        let query = getSearchQuery(view.state)\n\n        const wrapper = document.createElement('div')\n        const input = document.createElement('input')\n\n        wrapper.setAttribute('class', 'ink-mde-search-panel')\n        input.setAttribute('attr:main-field', 'true')\n        input.setAttribute('class', 'ink-mde-search-input')\n        input.setAttribute('type', 'text')\n        input.setAttribute('value', query.search)\n\n        wrapper.appendChild(input)\n\n        const handleKeyDown = (event: KeyboardEvent) => {\n          if (runScopeHandlers(view, event, 'search-panel')) return event.preventDefault()\n\n          if (event.code === 'Enter') {\n            event.preventDefault()\n\n            if (event.shiftKey) {\n              findPrevious(view)\n            } else {\n              findNext(view)\n            }\n          }\n        }\n\n        const updateSearch = (event: Event) => {\n          // @ts-expect-error \"value\" is not a recognized property of EventTarget.\n          const { value } = event.target\n\n          query = new SearchQuery({ search: value })\n\n          view.dispatch({ effects: setSearchQuery.of(query) })\n        }\n\n        input.addEventListener('input', updateSearch)\n        input.addEventListener('keydown', handleKeyDown)\n\n        return {\n          dom: wrapper,\n          mount: () => {\n            input.focus()\n          },\n          top: true,\n        }\n      },\n    }),\n    keymap.of(searchKeymap),\n  ]\n}\n"],"names":["search","searchExtension","top","createPanel","view","query","getSearchQuery","state","wrapper","document","createElement","input","setAttribute","appendChild","handleKeyDown","event","runScopeHandlers","preventDefault","code","shiftKey","findPrevious","findNext","updateSearch","value","target","SearchQuery","dispatch","effects","setSearchQuery","of","addEventListener","dom","mount","focus","keymap","searchKeymap"],"mappings":";;AAWaA,MAAAA,IAASA,MACb,CACLC,EAAgB;AAAA,EACdC,KAAK;AAAA,EACLC,aAAcC,CAAAA,MAAS;AACrB,QAAIC,IAAQC,EAAeF,EAAKG,KAAK;AAErC,UAAMC,IAAUC,SAASC,cAAc,KAAK,GACtCC,IAAQF,SAASC,cAAc,OAAO;AAE5CF,IAAAA,EAAQI,aAAa,SAAS,sBAAsB,GACpDD,EAAMC,aAAa,mBAAmB,MAAM,GAC5CD,EAAMC,aAAa,SAAS,sBAAsB,GAClDD,EAAMC,aAAa,QAAQ,MAAM,GACjCD,EAAMC,aAAa,SAASP,EAAML,MAAM,GAExCQ,EAAQK,YAAYF,CAAK;AAEzB,UAAMG,IAAiBC,CAAAA,MAAyB;AAC9C,UAAIC,EAAiBZ,GAAMW,GAAO,cAAc;AAAG,eAAOA,EAAME;AAEhE,MAAIF,EAAMG,SAAS,YACjBH,EAAME,eAAc,GAEhBF,EAAMI,WACRC,EAAahB,CAAI,IAEjBiB,EAASjB,CAAI;AAAA,OAKbkB,IAAgBP,CAAAA,MAAiB;AAErC,YAAM;AAAA,QAAEQ,OAAAA;AAAAA,UAAUR,EAAMS;AAExBnB,MAAAA,IAAQ,IAAIoB,EAAY;AAAA,QAAEzB,QAAQuB;AAAAA,MAAM,CAAC,GAEzCnB,EAAKsB,SAAS;AAAA,QAAEC,SAASC,EAAeC,GAAGxB,CAAK;AAAA,MAAE,CAAC;AAAA;AAGrDM,WAAAA,EAAMmB,iBAAiB,SAASR,CAAY,GAC5CX,EAAMmB,iBAAiB,WAAWhB,CAAa,GAExC;AAAA,MACLiB,KAAKvB;AAAAA,MACLwB,OAAOA,MAAM;AACXrB,QAAAA,EAAMsB,MAAK;AAAA,MACZ;AAAA,MACD/B,KAAK;AAAA;EAET;AACD,CAAA,GACDgC,EAAOL,GAAGM,CAAY,CAAC;"}